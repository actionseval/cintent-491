name: lint-check

# CINTENT >> MANUAL_TRIGGER
# on:
#   push:
#   pull_request:
#     branches:
#       - "main"
#       - "develop"
on: [repository_dispatch, workflow_dispatch]

jobs:
  # lint check can be auto-executed by the workflow
  lint-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      # CINTENT >> INSERT_CINTENT
      - uses: JavidDitty/setup-cintent@3638849e94bdb037f0a405375686a8550e6df904
        with:
          nonblocking: true

      - name: lint-flake8
        run: |
          pip install flake8
          FLAKE_DISABLE_LIST="F403,F405,W504,W503,E203"
          flake8 --max-line-length=120 --ignore=$FLAKE_DISABLE_LIST ./chat/web_demo.py

      - name: lint-isort
        run: |
          pip install isort==5.12.0
          isort --check --profile=black .

      # CINTENT >> INSERT_CINTENT
      - name: Upload CIntent Artifacts
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: ${{ env.CINTENT_ARTIFACT_NAME }}
          path: ${{ env.CINTENT_LOGS }}
